# Linux 进程调度

**Linux 进程** 可以分为  CPU 消耗类型和 IO 类型，Linux 内核的调度器通常倾向于提高系统的响应性，例如（桌面系统的实时响应）

## 1. 进程分类以及优先级

### 1.1 进程分类

   Linux 进程主要分为：内核线程  用户态线程 实时进程  守护进程以及轻量级进程

### 1.2  Linux 内核的进程优先级  实时优先级和普通优先级

- 实时优先级 轮流调度（SCHED_RR）和先进先出（SCHED_FIFO）
- 普通优先级  CFS （完全公平调度 -- 红黑树实现）和 nice 值（nice 值越低，进程优先级越高，反之则越低，最高是 -20，最低是 19）
- nice 优先级  在 Linux 中，nice 命令用于调整进程的优先级。进程的优先级范围从 -20 到 19，具体如下：
  **nice 优先级范围**
  - -20：最高优先级（优先级高于普通进程）。具有这个优先级的进程将获得更多的 CPU 时间。
  - 0：默认优先级。大多数进程的初始优先级。
  - 19：最低优先级（优先级低于普通进程）。具有这个优先级的进程将在 CPU 资源分配上处于劣势。

可以使用 nice 命令来启动一个新进程并设置其优先级。例如：

```bash
# 启动一个新进程，设置优先级为 10
nice -n 10 command
调整现有进程的优先级
要调整现有进程的优先级，可以使用 renice 命令。例如：

# 将进程 ID 为 1234 的进程优先级设置为 -5

sudo renice -5 -p 1234
```

**注意事项**
只有超级用户（root）可以将优先级设置为负值（-20 到 -1）。
普通用户只能设置优先级为 0 到 19 的值，不能提高其他用户进程的优先级。
**总结**
Linux 中的进程优先级范围从 -20 到 19，使用 nice 和 renice 命令可以管理进程的优先级，以便更有效地分配 CPU 资源。如果您有其他问题或需要更多信息，请告诉我！

## 2. 时间片以及调度算法

### 2.1 时间片

**时间片** 是操作系统（OS）将 CPU 分配给进程执行的时间段（默认的时间段是 10ms，时间片可以通过修改内核参数修改）

### 2.2 调度算法

- CFS （完全公平调度算法）
- RT（实时调度算法）
- MLFQ （多级反馈队列调度算法）
- RR 轮转调度算法

## 3. 多核调度原理与算法

### 3.1 多级调度原理

- 时间片
- 抢占式
- 优先级队列

### 3.2 Linux 内核多核调度算法

- CFS （完全公平调度算法）
- 实时调度算法 （FIFO Deadline 截止期调度算法，RR）

### 3.3 CFS 调度算法

 基于红黑树的时间片轮转调度算法，为每个任务维护一个虚拟运行时间来决定下一个被调度的任务

 **实现模式** 将所有正在执行的任务插入到一颗红黑树中，树节点按照虚拟运行时间进行排序，调度器优先选择最小运行时间的节点作为下一个要执行任务，并且将它移到树的末尾，
 目的（红黑树中的进程都得到相等的 CPU 时间）

 **CFS 优点** 公平性和扩展性

 **CFS 缺点** 可能导致上下文切换的频率不断增加，因为每次调度时需要遍历整个红黑树，来找到最小最小虚拟运行时间节点。

## 4. Linux 内核的
